---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: demo-app
  namespace: default
spec:
  interval: 60m
  releaseName: demo-app
  chart:
    spec:
      chart: ./charts/onechart
      version: 0.21.0
      sourceRef:
        kind: GitRepository
        name: onechart
      interval: 10m
  values:
    image:
      repository: nginx
      tag: 1.21.0
    ingress:
      annotations:
        kubernetes.io/ingress.class: nginx
        cert-manager.io/cluster-issuer: letsencrypt
      host: demo-app.gimlet.io
      tlsEnabled: true
    gitRepository: laszlocph/demo-app
    gitSha: xyz
---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: onechart
  namespace: default
spec:
  interval: 1m
  url: https://github.com/gimlet-io/onechart.git
  ref:
    branch: master
  ignore: |
    # exclude all
    /*
    # include charts directory
    !/charts/   